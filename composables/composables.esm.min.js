import{computed as e,ref as t,onMounted as u,onActivated as a,watch as l,nextTick as r}from"vue";function n(t,u){return e((()=>t||(e=>{do{e+=Math.floor(1e6*Math.random())}while(document.getElementById(e));return e})(u)))}function o(o,d){const i=t();let v=null,f=!0;const m=n(o.id,"input"),c=(e,t,u=!1)=>(e=String(e),"function"!=typeof o.formatter||o.lazyFormatter&&!u?e:(f=!1,o.formatter(e,t))),s=e=>o.trim?e.trim():o.number?parseFloat(e):e,p=()=>{r((()=>{o.autofocus&&i.value?.focus()}))};u(p),u((()=>{i.value&&(i.value.value=o.modelValue)})),a(p);const g=e((()=>o.ariaInvalid?o.ariaInvalid.toString():!1===o.state?"true":void 0));return l((()=>o.modelValue),(e=>{i.value&&(i.value.value=v&&f?v:e,v=null,f=!0)})),{input:i,computedId:m,computedAriaInvalid:g,onInput:e=>{const{value:t}=e.target,u=c(t,e);if(!1===u||e.defaultPrevented)return void e.preventDefault();if(o.lazy)return;d("input",u);const a=s(u);o.modelValue!==a&&(v=t,d("update:modelValue",a))},onChange:e=>{const{value:t}=e.target,u=c(t,e);if(!1===u||e.defaultPrevented)return void e.preventDefault();if(!o.lazy)return;v=t,d("update:modelValue",u);const a=s(u);o.modelValue!==a&&d("change",u)},onBlur:e=>{if(d("blur",e),!o.lazy&&!o.lazyFormatter)return;const{value:t}=e.target,u=c(t,e,!0);v=t,d("update:modelValue",u)},focus:()=>{o.disabled||i.value?.focus()},blur:()=>{o.disabled||i.value?.blur()}}}export{o as useFormInput,n as useId};
